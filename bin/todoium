#!/usr/bin/env bash

# set varibles
version="v0.3"
progname="$(basename "$0")"

# manually change this path if you want to use your own folder
tododir="$HOME/.todo/"

# make sure $tododir exists
if [ ! -d "$tododir" ]; then
	printf "Warning: %s does not exist\n" "$tododir"
	printf "Making it for you ... "
	mkdir -p "$tododir"
	printf "done\n"
fi

todo_help() {
	printf "\
Todoium %s - GPL v3
Usage: %s [OPTION] [todo]
" $version $progname 
	printf "\n"
	printf "\
  -h, --help    display help
"
	printf "\n"
	printf "\
  -l, --list    list todos
  -t, --tree    list todos in tree form
  -p, --path    show path of where todos are kept
"
	printf "\n"
}

todo_tree() {
	local treevar="$(tree "$tododir")"
	local treevar="$(echo "$treevar" | sed -e "s/files/todos/g" -)"
	local treevar="$(echo "$treevar" | sed -e "s/directory/sub-folder/g" -)"
	local treevar="$(echo "$treevar" | sed -e "s/directories/sub-folders/g" -)"
	echo "$treevar"
}

# handle options and file creation
case "$1" in
	# type `todoium -l` or `todoium` to list your todos
	""|-l|--list)
		ls -tr1 "$tododir"
		;;
	# use `todoium -h` to show help
	-h|--help)
		todo_help
		;;
	# use `todoium -t` to list your todos in a tree
	-t|--tree)
		todo_tree
		;;
	# use `todoium -p` to echo where the todos are being stored
	-p|--path)
		printf "%s\n" "$tododir"
		;;
	# if no options is specified then use $1 to create file 
	*)
		cd "$tododir"
		touch "$1"
		;;
esac

# vim: set shiftwidth=4 tabstop=4:
